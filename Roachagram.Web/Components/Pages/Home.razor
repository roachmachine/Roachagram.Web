@page "/"
@rendermode InteractiveServer

@using Microsoft.AspNetCore.Components.Web

<PageTitle>Roachagram!</PageTitle>

<SeoMeta
    Title="Roachagram! — Fast anagrams & summaries"
    Description="Roachagram transforms your words into clever anagrams and short summaries. We do not store any personally identifiable information."
    Keywords="anagram, name anagram, wordplay, roach machine, english, eduction"
    Canonical="https://roachagram.com/"
    Image="/roachagram-robot.png"
    JsonLd="@JsonLdData" />

<!-- Pinned privacy link -->
<div class="top-left">
    <NavLink href="/about" rel="noopener noreferrer">About</NavLink>
</div>
<div class="top-left">
    <NavLink href="/privacy" rel="noopener noreferrer">Privacy</NavLink>
</div>

<div style="min-width:320px;padding:10px;color:#376f78;font-family:monospace;">

    <div style="padding:10px;text-align:center;">
        <img src="/roachagram-robot.png"
             style="height:150px;object-fit:contain;display:block;margin:0 auto;" />
        <div>
            Powered by <a href="https://roachmachine.com" target="_blank" rel="noopener noreferrer">Roach Machine</a> © 2025
        </div>
        <div>
            Smart anagrams in ~15 seconds, sometimes a bit longer.
        </div>
    </div>

    <div style="display:flex;gap:10px;justify-content:center;align-items:center;">
        <input aria-label="Enter words or a name"
               class="ro-input"
               placeholder="@PlaceholderText"
               maxlength="15"
               disabled="@IsLoading"
               @bind="Input"
               @bind:event="oninput"
               @onkeydown="OnInputKeyDown"/>

        <button type="button"
                title="Submits input for anagrams"
                @onclick="OnSubmit"
                disabled="@IsLoading"
                class="ro-button">
            @ButtonText
        </button>
    </div>


    @if (IsLoading)
    {
        <div style="text-align:center;margin-top:20px;">
            <div class="spinner-border" style="width:100px;height:100px;color:#df6b2c">
                <span class="visually-hidden">Thinking...</span>
            </div>
        </div>
    }

    <div style="text-align:center;margin-top:20px;">
        @if (!string.IsNullOrEmpty(DisplayText))
        {
            <div id="typedText" style="font-family:monospace;white-space:pre-wrap;margin:0 auto;max-width:800px;text-align:left;">
                @((MarkupString)DisplayText)
            </div>
        }
    </div>
</div>

@code {
    private async Task OnInputKeyDown(KeyboardEventArgs e)
    {
        // Guard against accidental triggers while already processing
        if (IsLoading)
        {
            return;
        }

        // If Enter is pressed, submit
        if (e?.Key == "Enter")
        {
            await OnSubmit();
        }
    }
}